<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wisata Buatan Kalimantan Selatan</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    .carousel-item img { height: 100%; object-fit: cover; width: 100%; }
    .card { margin-bottom: 2rem; }
    .bintang {
      font-size: 24px;
      color: gray;
    }
    .bintang.aktif {
      color: gold;
    }
  </style>
</head>
<body style="background-color: #e6f0ff;">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top" style="background-color: #3b5998;">
      <div class="container-fluid">
        <a href="#"><img src="/z-instagram.png" alt="Logo" class="me-2 p-2 rounded-circle" style="height: 40px;"></a>
        <a href="#"><img src="/z-facebook.png" alt="Logo" class="me-2 p-2 rounded-circle" style="height: 40px;"></a>
        <a href="#"><img src="/z-youtube.png" alt="Logo" class="me-2 p-2 rounded-circle" style="height: 40px;"></a>
        <p class="navbar-brand fw-bold pt-3">Jelajah Banua</p>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="/homepage.html">Beranda</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="wisataDropdown" role="button" data-bs-toggle="dropdown">
                Wisata
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/wisata-alam.html">Wisata Alam</a></li>
                <li><a class="dropdown-item" href="/wisata-religi.html">Wisata Religi</a></li>
                <li><a class="dropdown-item" href="/wisata-edukasi.html">Wisata Edukasi</a></li>
                <li><a class="dropdown-item" href="/wisata-buatan.html">Wisata Buatan</a></li>
                <li><a class="dropdown-item" href="/wisata-budayaSejarah.html">Wisata Budaya & Sejarah</a></li>
                <li><a class="dropdown-item" href="/wisata-pertualangan.html">Wisata Petualangan</a></li>
                <li><a class="dropdown-item" href="/wisata-kuliner.html">Wisata Kuliner</a></li>
              </ul>
            </li>
            <li class="nav-item"><a class="nav-link" href="#">Tour Guide</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Tentang Kami</a></li>
            <li class="nav-item"><a class="nav-link" href="#">Hubungi Kami</a></li>
          </ul>
        </div>
      </div>
    </nav>

  <div class="container py-5">
    <div id="wisata-container"></div>
  </div>

  <footer class="text-light pt-5 pb-3" style="background-color: #3b5998;">
      <div class="container">
        <div class="row gy-4">
          <div class="col-md-4">
            <h3 class="text-warning fs-5 mb-2">Jelajah Banua</h3>
            <p class="mb-0">Portal Wisata Digital Kalimantan Selatan</p>
          </div>
          <div class="col-md-4">
            <h3 class="text-warning fs-5 mb-2">Navigasi</h3>
            <ul class="list-unstyled">
              <li class="mb-2"><a href="#" class="text-light text-decoration-none">Beranda</a></li>
              <li class="mb-2"><a href="#" class="text-light text-decoration-none">Destinasi Wisata</a></li>
              <li class="mb-2"><a href="#" class="text-light text-decoration-none">Tour Guide</a></li>
              <li class="mb-2"><a href="#" class="text-light text-decoration-none">Tentang Kami</a></li>
              <li class="mb-2"><a href="#" class="text-light text-decoration-none">Hubungi Kami</a></li>
            </ul>
          </div>
          <div class="col-md-4">
            <h3 class="text-warning fs-5 mb-2">Kontak</h3>
            <p class="mb-1">Email: info@jelajahbanua.com</p>
            <p class="mb-2">Telepon: +62 815 2151 9244</p>
          </div>
        </div>

        <div class="text-center border-top border-secondary pt-3 mt-4 text-light small">
          © 2025 Jelajah Banua. All right reserved. |
          <a href="#" class="text-decoration-none text-light">Kebijakan Privasi</a> |
          <a href="#" class="text-decoration-none text-light">Syarat & Ketentuan</a>
        </div>
      </div>
    </footer>

  <!-- Ambil Data JSON -->
   <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    Promise.all([
      fetch("tempat-alam.json").then(res => res.json()),
      fetch("tempat-religi.json").then(res => res.json()),
      fetch("tempat-edukasi.json").then(res => res.json()),
      fetch("tempat-buatan.json").then(res => res.json()),
      fetch("tempat-budayaSejarah.json").then(res => res.json()),
      fetch("tempat-kuliner.json").then(res => res.json()),
      fetch("tempat-pertualangan.json").then(res => res.json())
    ])
    .then(([alam, religi, edukasi, buatan, budayaSejarah, kuliner, pertualangan]) => {
      const semuaTempat = { ...alam, ...religi, ...edukasi, ...buatan, ...budayaSejarah, ...kuliner, ...pertualangan };
      const tempat = semuaTempat[id];

      const container = document.getElementById("wisata-container");
      container.innerHTML = "";

      if (!tempat) {
        container.innerHTML = `<div class="alert alert-danger">Tempat wisata tidak ditemukan.</div>`;
        return;
      }

      const carouselId = `carousel-${id}`;
      const images = (tempat.gambar || []).map((img, i) => `
        <div class="carousel-item${i === 0 ? ' active' : ''}">
          <img src="${img}" class="d-block w-100" alt="${tempat.nama} ${i+1}">
        </div>
      `).join("");

      const tiket = tempat["harga-tiket"]
        ? Object.entries(tempat["harga-tiket"]).map(
            ([jenis, harga]) => `<li>${jenis.replace('_', ' ')}: ${harga}</li>`
          ).join("")
        : "<li>Informasi tidak tersedia</li>";

      const fasilitas = tempat.fasilitas && tempat.fasilitas.length
        ? tempat.fasilitas.map(f => `<li>${f}</li>`).join("")
        : "<li>Informasi tidak tersedia</li>";

      container.innerHTML = `
        <div class="card shadow-sm">
          <div class="card-body">
            <div id="${carouselId}" class="carousel slide mb-3" data-bs-ride="carousel">
              <div class="carousel-inner">${images}</div>
              <button class="carousel-control-prev" type="button" data-bs-target="#${carouselId}" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#${carouselId}" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
              </button>
            </div>
            <h3>${tempat.nama}</h3>
            <p>${tempat.lokasi}</p>
            <div>
              <strong>Deskripsi Wisata:</strong>
              <div style="max-height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px; background-color: white;">
                ${tempat["deskripsi"] || "Informasi tidak tersedia"}
              </div>
            </div>
            <p><strong><br>Jam Operasional:</strong> ${tempat["jam-operasional"] || "Informasi tidak tersedia"}</p>
            <div><strong>Harga Tiket:</strong><ul>${tiket}</ul></div>
            <div><strong>Fasilitas:</strong><ul>${fasilitas}</ul></div>

            <!-- RATING -->
            <div id="rating-pengunjung" class="mt-3">
              <strong>Rating Pengunjung:</strong>
              <div id="bintang-container">
                <span class="bintang" data-nilai="1">★</span>
                <span class="bintang" data-nilai="2">★</span>
                <span class="bintang" data-nilai="3">★</span>
                <span class="bintang" data-nilai="4">★</span>
                <span class="bintang" data-nilai="5">★</span>
              </div>
              <p id="info-rating">Memuat rating...</p>
            </div>

            <a href="detail-tempat.html?id=${id}" class="btn btn-warning mt-2">Lihat Selanjutnya</a>
          </div>
        </div>
      `;

      function tampilkanRating(id) {
      const db = firebase.database().ref("tempat_wisata/" + id);
      db.once("value").then(snapshot => {
        const data = snapshot.val() || { totalNilai: 0, jumlahPenilai: 0 };
        const rata2 = data.jumlahPenilai === 0 ? 0 : (data.totalNilai / data.jumlahPenilai);
        const rata2fix = rata2.toFixed(2);

        const infoRating = document.getElementById("info-rating");
        const bintangEls = document.querySelectorAll("#bintang-container .bintang");

        if (infoRating) {
          infoRating.innerText = `Rating: ${rata2fix} dari ${data.jumlahPenilai} penilai`;
        }

        bintangEls.forEach(el => {
          const nilai = parseInt(el.dataset.nilai);
          if (nilai <= Math.floor(rata2)) {
            el.classList.add("aktif");
          }
        });
      });
    }
      // Inisialisasi Firebase rating setelah data tempat ditampilkan
      tampilkanRating(id);
    })
    .catch(error => {
      document.getElementById("wisata-container").innerHTML = `<div class="alert alert-danger">${error.message}</div>`;
    });
  </script>

  
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBK1vKLs1KdsAfgex8uue77T8BH98p6tRY",
      authDomain: "percobaanrating.firebaseapp.com",
      databaseURL: "https://percobaanrating-default-rtdb.firebaseio.com",
      projectId: "percobaanrating",
      storageBucket: "percobaanrating.appspot.com",
      messagingSenderId: "904226782106",
      appId: "1:904226782106:web:0190958c1a93ed677f9823"
    };
    // Inisialisasi Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const database = firebase.database(app);

  </script>
</body>
</html>
